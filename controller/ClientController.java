package controller;

import model.AI.AI;
import model.AI.negaAI;
import model.AI.randomAI;
import model.game.Game;
import model.game.Reversi;
import model.game.TicTacToe;
import view.Window;

import java.awt.Point;
import java.util.*;

public class ClientController {

    private ServerCommand serverCommander;
    private Window window;
    private Reversi reversiGame;
    private TicTacToe ticTacToeGame;
    private Game currentGame;
    private AI currentAI;

    private boolean myTurn = true;
    private boolean playingAsAI;
    private boolean connected;
    private boolean isLoggedIn;
    private boolean gameIsOver;
    private String username;
    private String opponentName;
    private String serverComment;
    String gametype;

    private byte opp = 2;
    private byte turn = 1;
    private byte playerTurn;

	LinkedList<Integer> movelist = new LinkedList<Integer>();
	Hashtable<Integer, List> inviteTable = new Hashtable<>();

	char[][] openings = {
		{'f','5','f','6','e','6','f','4','g','5','e','7','f','7','c','5','e','3','f','3','c','4','d','3','c','2'},
		{'f','5','f','6','e','6','f','4','g','5','e','7','e','3'},
		{'f','5','f','6','e','6','f','4','g','5','e','7','d','7'},
		{'f','5','f','6','e','6','f','4','g','5','d','6'},
		{'f','5','f','6','e','6','f','4','g','5'},
		{'f','5','f','6','e','6','f','4','g','7'},
		{'f','5','f','6','e','6','f','4','g','6','c','5','g','4','g','5','f','3','e','3','c','4'},
		{'f','5','f','6','e','6','f','4','g','6'},
		{'f','5','f','6','e','6','f','4','g','4'},
		{'f','5','f','6','e','6','f','4','g','3','f','3','g','4'},
		{'f','5','f','6','e','6','f','4','g','3','d','6'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','g','5','f','3','g','4','g','6','g','3','d','6','f','7','h','5','h','4','h','3','e','7'},
		{'f','5','f','6','e','6','f','4','e','3','d','6'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','g','5','g','3','g','4','f','3','g','6'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','g','5','g','3','g','4','f','3','c','4'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','g','5','d','6','g','6'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','g','5'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4','e','7','g','4'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4','e','7','b','5','e','2'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4','e','7'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4','d','3','f','3','e','2'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4','d','3','c','3'},
		{'f','5','f','6','e','6','f','4','e','3','c','5','c','4'},
		{'f','5','f','6','e','6','f','4','e','3'},
		{'f','5','f','6','e','6','f','4','c','3','d','7','f','3'},
		{'f','5','f','6','e','6','f','4','c','3','d','6','f','3','c','4','c','5','b','4'},
		{'f','5','f','6','e','6','f','4','c','3','c','4'},
		{'f','5','f','6','e','6','f','4','c','3'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','e','7','c','6','d','7','f','7','c','7','f','4','g','6','e','8','d','8','c','8','g','5'},
		{'f','5','f','6','e','6','d','6','g','7'},
		{'f','5','f','6','e','6','d','6','f','7','e','3','d','7','e','7','c','6','c','5','d','3'},
		{'f','5','f','6','e','6','d','6','f','7'},
		{'f','5','f','6','e','6','d','6','e','7','g','5','g','6','e','3','c','5','c','6','d','3','c','4','b','3'},
		{'f','5','f','6','e','6','d','6','e','7','g','5','g','4'},
		{'f','5','f','6','e','6','d','6','e','7','g','5','c','5'},
		{'f','5','f','6','e','6','d','6','e','7','f','4'},
		{'f','5','f','6','e','6','d','6','e','7'},
		{'f','5','f','6','e','6','d','6','d','7'},
		{'f','5','f','6','e','6','d','6','c','7','f','4'},
		{'f','5','f','6','e','6','d','6','c','7','c','6','d','7'},
		{'f','5','f','6','e','6','d','6','c','5','f','4'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','e','7','f','4','f','7'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','e','7','c','7','d','7','c','6','f','7'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','e','7','c','7','d','7','c','6','d','3'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','e','7'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3','g','5','e','2','b','5'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3','g','5','d','7'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3','g','5'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3','c','4','c','6','b','5'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3','c','4','c','3'},
		{'f','5','f','6','e','6','d','6','c','5','e','3','d','3'},
		{'f','5','f','6','e','6','d','6','c','5'},
		{'f','5','f','6','e','6','d','6','c','3','g','4','c','6'},
		{'f','5','f','6','e','6','d','6','c','3','f','4','c','6','d','3','e','3','d','2'},
		{'f','5','f','6','e','6','d','6','c','3','d','3'},
		{'f','5','f','6','e','6','d','6','c','3'},
		{'f','5','f','6','d','3','f','4'},
		{'f','5','f','6','c','4','f','4'},
		{'f','5','f','6'},
		{'f','5','f','4'},
		{'f','5','d','6','c','5','f','4','e','3','d','3'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','4','c','4','g','5','c','3','f','7','d','2','e','7','f','2'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','f','3'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','e','6','f','6'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','e','6'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','7'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','4','c','4','g','6'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','4','c','4'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','4'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','3','c','4','g','5','c','3','b','4','e','2'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','3','c','4','b','4','c','3'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','3','c','4','b','4'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','g','3','c','4'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7','e','7'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','6','e','6','d','7'},
		{'f','5','d','6','c','5','f','4','e','3','c','6','d','3','f','3'},
		{'f','5','d','6','c','5','f','4','d','3'},
		{'f','5','d','6','c','4','g','5','c','6','c','5','d','7','d','3','b','4','c','3','e','3','f','3'},
		{'f','5','d','6','c','4','g','5','c','6'},
		{'f','5','d','6','c','4','g','5'},
		{'f','5','d','6','c','4','d','3','e','6'},
		{'f','5','d','6','c','4','d','3','c','5','f','4','e','3','f','3','c','2','c','6'},
		{'f','5','d','6','c','4','d','3','c','5','f','4','e','3','f','3','c','2','b','4','b','3'},
		{'f','5','d','6','c','4','d','3','c','5'},
		{'f','5','d','6','c','3','g','5'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','c','5','b','4','b','5','c','6','f','3','e','6','e','3','g','6','f','6','g','5','d','7','g','3'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','f','6','g','5','e','3','f','3','g','4','h','3','g','3','f','2'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','f','6','g','5'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','f','6','f','3'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','f','6','b','4'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','f','6'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','e','6'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','e','3'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','c','5','b','4','b','5','c','6','f','3','e','6','e','3'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','c','5','b','3','c','2','e','6'},
		{'f','5','d','6','c','3','d','3','c','4','f','4','c','5','b','3','c','2'},
		{'f','5','d','6','c','3','d','3','c','4','b','3'},
		{'f','5','d','6','c','3','d','3','c','4'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','g','5','f','3','g','4','g','6','g','3','d','6','f','7','h','5','h','4','h','3','e','7'},
		{'e','6','f','6','f','5','f','4','g','7'},
		{'e','6','f','6','f','5','f','4','g','6','c','5','g','4','g','5','f','3','e','3','c','4'},
		{'e','6','f','6','f','5','f','4','g','6'},
		{'e','6','f','6','f','5','f','4','g','5','e','7','f','7','c','5','e','3','f','3','c','4','d','3','c','2'},
		{'e','6','f','6','f','5','f','4','g','5','e','7','e','3'},
		{'e','6','f','6','f','5','f','4','g','5','e','7','d','7'},
		{'e','6','f','6','f','5','f','4','g','5','d','6'},
		{'e','6','f','6','f','5','f','4','g','5'},
		{'e','6','f','6','f','5','f','4','g','4'},
		{'e','6','f','6','f','5','f','4','g','3','f','3','g','4'},
		{'e','6','f','6','f','5','f','4','g','3','d','6'},
		{'e','6','f','6','f','5','f','4','e','3','d','6'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','g','5','g','3','g','4','f','3','g','6'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','g','5','g','3','g','4','f','3','c','4'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','g','5','d','6','g','6'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','g','5'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4','e','7','g','4'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4','e','7','b','5','e','2'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4','e','7'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4','d','3','f','3','e','2'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4','d','3','c','3'},
		{'e','6','f','6','f','5','f','4','e','3','c','5','c','4'},
		{'e','6','f','6','f','5','f','4','e','3'},
		{'e','6','f','6','f','5','f','4','c','3','d','7','f','3'},
		{'e','6','f','6','f','5','f','4','c','3','d','6','f','3','c','4','c','5','b','4'},
		{'e','6','f','6','f','5','f','4','c','3','c','4'},
		{'e','6','f','6','f','5','f','4','c','3'},
		{'e','6','f','6','f','5','d','6','g','7'},
		{'e','6','f','6','f','5','d','6','f','7','e','3','d','7','e','7','c','6','c','5','d','3'},
		{'e','6','f','6','f','5','d','6','f','7'},
		{'e','6','f','6','f','5','d','6','e','7','g','5','g','6','e','3','c','5','c','6','d','3','c','4','b','3'},
		{'e','6','f','6','f','5','d','6','e','7','g','5','g','4'},
		{'e','6','f','6','f','5','d','6','e','7','g','5','c','5'},
		{'e','6','f','6','f','5','d','6','e','7','f','4'},
		{'e','6','f','6','f','5','d','6','e','7'},
		{'e','6','f','6','f','5','d','6','d','7'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','e','7','c','6','d','7','f','7','c','7','f','4','g','6','e','8','d','8','c','8','g','5'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','e','7','f','4','f','7'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','e','7','c','7','d','7','c','6','f','7'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','e','7','c','7','d','7','c','6','d','3'},
		{'e','6','f','6','f','5','d','6','c','7','f','4'},
		{'e','6','f','6','f','5','d','6','c','7','c','6','d','7'},
		{'e','6','f','6','f','5','d','6','c','5','f','4'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','e','7'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3','g','5','e','2','b','5'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3','g','5','d','7'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3','g','5'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3','c','4','c','6','b','5'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3','c','4','c','3'},
		{'e','6','f','6','f','5','d','6','c','5','e','3','d','3'},
		{'e','6','f','6','f','5','d','6','c','5'},
		{'e','6','f','6','f','5','d','6','c','3','g','4','c','6'},
		{'e','6','f','6','f','5','d','6','c','3','f','4','c','6','d','3','e','3','d','2'},
		{'e','6','f','6','f','5','d','6','c','3','d','3'},
		{'e','6','f','6','f','5','d','6','c','3'},
		{'e','6','f','6','d','3','d','6'},
		{'e','6','f','6','c','4','d','6'},
		{'e','6','f','6'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','g','4'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','f','5','f','6'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','f','5'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','6'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','d','7','d','3','e','7','c','3','g','6','b','4','g','5','b','6'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','g','5'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','d','7','d','3','f','7'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','d','7','d','3'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','d','7'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','c','7','d','3','e','7','c','3','d','2','b','5'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','c','7','d','3','d','2','c','3'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','c','7','d','3','d','2'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4','c','7','d','3'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','f','6','f','5','g','4'},
		{'e','6','f','4','e','3','d','6','c','5','f','3','c','4','c','6'},
		{'e','6','f','4','e','3','d','6','c','5','c','4'},
		{'e','6','f','4','e','3','d','6','c','4'},
		{'e','6','f','4','d','3','e','7','f','3','e','3','g','4','c','4','d','2','c','3','c','5','c','6'},
		{'e','6','f','4','d','3','e','7','f','3'},
		{'e','6','f','4','d','3','e','7'},
		{'e','6','f','4','d','3','c','4','f','5'},
		{'e','6','f','4','d','3','c','4','e','3','d','6','c','5','c','6','b','3','f','3'},
		{'e','6','f','4','d','3','c','4','e','3','d','6','c','5','c','6','b','3','d','2','c','2'},
		{'e','6','f','4','d','3','c','4','e','3'},
		{'e','6','f','4','c','3','e','7'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','6','e','7','c','5','c','6','d','7','c','8','c','7','b','6'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','6','e','7'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','6','d','2'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','6','c','6'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','6'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','f','5'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','e','3','d','2','e','2','f','3','c','6','f','5','c','5','f','7','f','6','e','7','g','4','c','7'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','e','3','d','2','e','2','f','3','c','6','f','5','c','5'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','e','3','c','2','b','3','f','5'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','e','3','c','2','b','3'},
		{'e','6','f','4','c','3','c','4','d','3','d','6','c','5'},
		{'e','6','f','4','c','3','c','4','d','3','c','2'},
		{'e','6','f','4','c','3','c','4','d','3'},
		{'e','6','f','4'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','d','6','e','7','d','7','c','6','f','3','c','4','f','4','c','2','c','3','d','2','b','5','f','2'},
		{'d','3','e','3'},
		{'d','3','c','5','f','6','f','5','e','6','f','7'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','f','4'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','d','6','f','7','g','6','c','4'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','d','6','f','7','g','6'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','d','6','e','7','d','7','c','6','f','3','c','4','f','4'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','4'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','3','f','3'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','3','e','7'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','3','d','2','f','4','f','3','e','2','f','1','f','2','g','3'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','3','d','2'},
		{'d','3','c','5','f','6','f','5','e','6','e','3','c','3'},
		{'d','3','c','5','f','6','f','5','e','6'},
		{'d','3','c','5','f','6','d','2'},
		{'d','3','c','5','e','6','f','5','d','6','e','3','f','4','f','3','g','6','e','7','f','7'},
		{'d','3','c','5','e','6','f','5','d','6','e','3','f','4','f','3','g','6','c','6'},
		{'d','3','c','5','e','6','f','5','d','6'},
		{'d','3','c','5','e','6','f','5','c','4'},
		{'d','3','c','5','e','6','d','2','c','6','d','6','b','5','f','5','e','7','f','6','f','4','f','3'},
		{'d','3','c','5','e','6','d','2','c','6'},
		{'d','3','c','5','e','6','d','2'},
		{'d','3','c','5','d','6','e','3','f','5'},
		{'d','3','c','5','d','6','e','3','f','4','f','5'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','f','3'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','f','2','e','6','e','7','f','6'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','f','2','e','6','e','7'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','f','2','e','6','d','2','f','6','e','7','g','4'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','f','2','e','6'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','e','2','e','6','d','2','f','6','b','3','g','5','b','4','g','3'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','e','2','e','6','c','2'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','e','2','e','6'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','e','2'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5','b','4'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','5','c','3','c','4','b','5'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','f','3'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','c','4','c','3'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','c','4'},
		{'d','3','c','5','d','6','e','3','f','4','c','6','b','5'},
		{'d','3','c','5'},
		{'d','3','c','3','f','5','e','3'},
		{'d','3','c','3','e','6','e','3'},
		{'d','3','c','3','c','4','e','3','f','6','e','6'},
		{'d','3','c','3','c','4','e','3','f','6','c','5','f','3','e','6','d','6','e','7'},
		{'d','3','c','3','c','4','e','3','f','6','b','5','f','3'},
		{'d','3','c','3','c','4','e','3','f','6'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6','f','5','f','6'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6','f','5','f','3','g','4'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6','b','4','e','2'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6','b','4','d','7','g','4'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6','b','4'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','e','6'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','d','2','f','3','e','2','c','2','f','2','c','5','b','3','d','1','e','1','f','1','b','4'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','d','2','f','2','e','2','f','3','e','6'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','d','2','f','2','e','2','f','3','c','2'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','d','2','c','5','c','2'},
		{'d','3','c','3','c','4','e','3','f','4','d','6','d','2'},
		{'d','3','c','3','c','4','e','3','f','4','c','5'},
		{'d','3','c','3','c','4','e','3','f','4'},
		{'d','3','c','3','c','4','e','3','f','2','f','3','e','2'},
		{'d','3','c','3','c','4','e','3','f','2','c','5'},
		{'d','3','c','3','c','4','e','3','e','2'},
		{'d','3','c','3','c','4','e','3','d','2','c','5'},
		{'d','3','c','3','c','4','e','3','d','2','b','4','f','4'},
		{'d','3','c','3','c','4','e','3','d','2','b','4','b','5'},
		{'d','3','c','3','c','4','e','3','d','2','b','4','b','3','d','6','f','4','f','3','e','6','f','5','g','6'},
		{'d','3','c','3','c','4','e','3','d','2'},
		{'d','3','c','3','c','4','e','3','c','2','d','6','e','2','d','2','f','3','f','4','e','6'},
		{'d','3','c','3','c','4','e','3','c','2'},
		{'d','3','c','3','c','4','e','3','b','2'},
		{'d','3','c','3','c','4','c','5','f','6','f','5'},
		{'d','3','c','3','c','4','c','5','f','6','e','3','c','6','f','5','f','4','g','5'},
		{'d','3','c','3','c','4','c','5','f','6','e','2','c','6'},
		{'d','3','c','3','c','4','c','5','f','6'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5','e','6','f','6'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5','e','6','c','6','d','7'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5','d','2','g','4','d','7'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5','d','2','b','5'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5','d','2'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','f','5'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','b','4','e','3','b','3'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','b','4','c','6','b','5','b','3','b','6','e','3','c','2','a','4','a','5','a','6','d','2'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','b','4','b','6','b','5','c','6','f','5'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','b','4','b','6','b','5','c','6','b','3'},
		{'d','3','c','3','c','4','c','5','d','6','f','4','b','4'},
		{'d','3','c','3','c','4','c','5','d','6','e','3'},
		{'d','3','c','3','c','4','c','5','d','6'},
		{'d','3','c','3','c','4','c','5','b','6','e','3'},
		{'d','3','c','3','c','4','c','5','b','6','c','6','b','5'},
		{'d','3','c','3','c','4','c','5','b','5'},
		{'d','3','c','3','c','4','c','5','b','4','e','3'},
		{'d','3','c','3','c','4','c','5','b','4','d','2','e','2'},
		{'d','3','c','3','c','4','c','5','b','4','d','2','d','6'},
		{'d','3','c','3','c','4','c','5','b','4','d','2','c','2','f','4','d','6','c','6','f','5','e','6','f','7'},
		{'d','3','c','3','c','4','c','5','b','4'},
		{'d','3','c','3','c','4','c','5','b','3','f','4','b','5','b','4','c','6','d','6','f','5'},
		{'d','3','c','3','c','4','c','5','b','3'},
		{'d','3','c','3','c','4','c','5','b','2'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','f','4','g','5','g','4','f','3','c','6','d','3','d','6','b','3','c','3','b','4','e','2','b','6'},
		{'c','4','e','3','f','6','e','6','f','5','g','6'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','f','4','g','6','f','7','d','3'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','f','4','g','6','f','7'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','f','4','g','5','g','4','f','3','c','6','d','3','d','6'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','d','6'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','d','3'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','c','3','g','5'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','c','3','c','6'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','c','3','b','4','d','6','c','6','b','5','a','6','b','6','c','7'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','c','3','b','4'},
		{'c','4','e','3','f','6','e','6','f','5','c','5','c','3'},
		{'c','4','e','3','f','6','e','6','f','5'},
		{'c','4','e','3','f','6','b','4'},
		{'c','4','e','3','f','5','e','6','f','4','c','5','d','6','c','6','f','7','g','5','g','6'},
		{'c','4','e','3','f','5','e','6','f','4','c','5','d','6','c','6','f','7','f','3'},
		{'c','4','e','3','f','5','e','6','f','4'},
		{'c','4','e','3','f','5','e','6','d','3'},
		{'c','4','e','3','f','5','b','4','f','3','f','4','e','2','e','6','g','5','f','6','d','6','c','6'},
		{'c','4','e','3','f','5','b','4','f','3'},
		{'c','4','e','3','f','5','b','4'},
		{'c','4','e','3','f','4','c','5','e','6'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','6'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','d','2'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','6','f','5','g','5','f','6'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','6','f','5','g','5'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','6','f','5','b','4','f','6','g','5','d','7'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','6','f','5'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','5','f','5','b','4','f','6','c','2','e','7','d','2','c','7'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','5','f','5','b','3'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','5','f','5'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2','b','5'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','6','c','3','d','3','e','2'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','e','2'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','d','3','c','3'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','d','3'},
		{'c','4','e','3','f','4','c','5','d','6','f','3','c','6'},
		{'c','4','e','3','f','4','c','5','d','6','e','6'},
		{'c','4','e','3'},
		{'c','4','c','5'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','b','4','c','6','b','5','b','3','b','6','e','3','c','2','a','4','a','5','a','6','d','2'},
		{'c','4','c','3','f','5','c','5'},
		{'c','4','c','3','e','6','c','5'},
		{'c','4','c','3','d','3','e','3','f','6','e','6'},
		{'c','4','c','3','d','3','e','3','f','6','c','5','f','3','e','6','d','6','e','7'},
		{'c','4','c','3','d','3','e','3','f','6','b','5','f','3'},
		{'c','4','c','3','d','3','e','3','f','6'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6','f','5','f','6'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6','f','5','f','3','g','4'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6','b','4','e','2'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6','b','4','d','7','g','4'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6','b','4'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','e','6'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','d','2','f','3','e','2','c','2','f','2','c','5','b','3','d','1','e','1','f','1','b','4'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','d','2','f','2','e','2','f','3','e','6'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','d','2','f','2','e','2','f','3','c','2'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','d','2','c','5','c','2'},
		{'c','4','c','3','d','3','e','3','f','4','d','6','d','2'},
		{'c','4','c','3','d','3','e','3','f','4','c','5'},
		{'c','4','c','3','d','3','e','3','f','4'},
		{'c','4','c','3','d','3','e','3','f','2','f','3','e','2'},
		{'c','4','c','3','d','3','e','3','f','2','c','5'},
		{'c','4','c','3','d','3','e','3','e','2'},
		{'c','4','c','3','d','3','e','3','d','2','c','5'},
		{'c','4','c','3','d','3','e','3','d','2','b','4','f','4'},
		{'c','4','c','3','d','3','e','3','d','2','b','4','b','5'},
		{'c','4','c','3','d','3','e','3','d','2','b','4','b','3','d','6','f','4','f','3','e','6','f','5','g','6'},
		{'c','4','c','3','d','3','e','3','d','2'},
		{'c','4','c','3','d','3','e','3','c','2','d','6','e','2','d','2','f','3','f','4','e','6'},
		{'c','4','c','3','d','3','e','3','c','2'},
		{'c','4','c','3','d','3','e','3','b','2'},
		{'c','4','c','3','d','3','c','5','f','6','f','5'},
		{'c','4','c','3','d','3','c','5','f','6','e','3','c','6','f','5','f','4','g','5'},
		{'c','4','c','3','d','3','c','5','f','6','e','2','c','6'},
		{'c','4','c','3','d','3','c','5','f','6'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5','e','6','f','6'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5','e','6','c','6','d','7'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5','d','2','g','4','d','7'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5','d','2','b','5'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5','d','2'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','f','5'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','b','4','e','3','b','3'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','b','4','b','6','b','5','c','6','f','5'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','b','4','b','6','b','5','c','6','b','3'},
		{'c','4','c','3','d','3','c','5','d','6','f','4','b','4'},
		{'c','4','c','3','d','3','c','5','d','6','e','3'},
		{'c','4','c','3','d','3','c','5','d','6'},
		{'c','4','c','3','d','3','c','5','b','6','e','3'},
		{'c','4','c','3','d','3','c','5','b','6','c','6','b','5'},
		{'c','4','c','3','d','3','c','5','b','5'},
		{'c','4','c','3','d','3','c','5','b','4','e','3'},
		{'c','4','c','3','d','3','c','5','b','4','d','2','e','2'},
		{'c','4','c','3','d','3','c','5','b','4','d','2','d','6'},
		{'c','4','c','3','d','3','c','5','b','4','d','2','c','2','f','4','d','6','c','6','f','5','e','6','f','7'},
		{'c','4','c','3','d','3','c','5','b','4'},
		{'c','4','c','3','d','3','c','5','b','3','f','4','b','5','b','4','c','6','d','6','f','5'},
		{'c','4','c','3','d','3','c','5','b','3'},
		{'c','4','c','3','d','3','c','5','b','2'},
		{'c','4','c','3'}
	};

	private Point playOpening(int progress, byte color) {
		System.out.println("--------------------opening uitvoeren");
		// flip: i = j, j = i en 8-i, 8-j, 8-j, 8-i
		progress = (progress-4);
		int x = 0, y = 0;
		int variantStep = 0;
		byte col=color;
		byte[][] openingB = new byte[8][8];
		byte[][] mBoard = new byte[8][8];
		for (int i = 0; i < 8; i++)
			mBoard[i] = currentGame.getBoard()[i].clone();

		for (int i = 0; i < 8; i++)
			for (int j = 0; j < 8; j++)
				if(mBoard[i][j]<0)
					mBoard[i][j]=0;

		for (int variant = 0; variant < openings.length; variant++) { // voor elke opening sequence
			// reset het bord en de kleur
			for (int i = 0; i < 8; i++)
				for (int j = 0; j < 8; j++)
					openingB[i][j]=0;
			openingB[3][3]= currentGame.WHITE;
			openingB[3][4]= currentGame.BLACK;
			openingB[4][3]= currentGame.BLACK;
			openingB[4][4]= currentGame.WHITE;
			if(color==currentGame.BLACK)
				col = color==currentGame.BLACK?currentGame.WHITE:currentGame.BLACK;
			variantStep = 0;

			if((openings[variant].length/2)>progress){
				for(int mProg=0; mProg < progress; mProg++){ // elk teken in de sequence
					y = openings[variant][variantStep]-96; // letter deel van de zet
					x = openings[variant][variantStep+1]-48; // cijfer deel van de zet
					col = col==currentGame.BLACK?currentGame.WHITE:currentGame.BLACK; // draai kleur om
					openingB[x-1][y-1] = col; // zet op bord
					reversiGame.flipv2(openingB, col, x-1, y-1);
					variantStep+=2;
				}
			}
			if(Arrays.deepEquals(mBoard, openingB)){
				System.out.println("--------------------------------------------------EEN MATCH-----------------------------------------------------------------");
				if(openings[variant].length>variantStep+1){
						System.out.println(openings[variant][variantStep]+""+openings[variant][variantStep+1]);
						return new Point(openings[variant][(variantStep)+1]-49, openings[variant][(variantStep)]-97);
				}
			}
		}
		return null;
	}

    public ClientController() {
        reversiGame = new Reversi(this);
        ticTacToeGame = new TicTacToe(this);
        window = new Window(this);
    }

    public void update(ArrayList<String> message){
		// System.out.println("controller update: "+message);
        switch(message.get(0)) {
            case "MATCH":
                gameIsOver = false;
                gametype = message.get(5);
                opponentName = message.get(8);
				System.out.println("oppname: " + opponentName);
                String playingAs = window.getGameSettingsPanel().getPlayAs();
                startGame(gametype, playingAs);
                System.out.println("Player to start: " + message.get(2));

                if(!message.get(2).equals(username)) {
                    myTurn = false;
                    updateSidebarTurnLabel(opponentName);
                    setOpponentColor(1);

                } else {
					// account for rematches
                    myTurn = true;
					setOpponentColor(2);
                    currentGame.highlightPossibleMoves(turn);
				}
                updateSideBarReversiScore();
                break;
            case "MOVE":
				int move = Integer.valueOf(message.get(5).replaceAll("\"", ""));
				int i = move/8;
				int j = move%8;
				if(gametype.equals("Tic-tac-toe")) {
				    i = move/3;
				    j = move%3;
                }
                if(!message.get(2).equals(username)) {
					movelist.add(move);
                    System.out.println("Opponent move: " + move);
                    play(i, j, opp);
                } else {
					movelist.add(move);
                    System.out.println("My move: " + move);
                    play(i, j, turn);
                }
                currentGame.updateView();
                break;
            case "YOURTURN":
				myTurn = true;
                updateSidebarTurnLabel("is you");
				currentGame.highlightPossibleMoves(turn);
                /** AI plays */
                if(playingAsAI) {
                    System.out.println("AI turn: " + turn);
					Point AImove = playOpening(currentGame.pieces(), turn);
					if(AImove==null){
						System.out.println("---------------------------------------------AImove was null");
						AImove = currentAI.findMove(turn);
					}
                    System.out.println("AI move: " + AImove);
                    playMove(AImove.x, AImove.y, turn);
                }
                break;
            case "WIN":
                gameIsOver = true;
                System.out.println("Its a win");
                //currentGame.setWinner(turn);
                serverComment = message.get(8);
                updateResultLabel("You won!");
                break;
            case "LOSS":
                gameIsOver = true;
                System.out.println("Its a loss");
                //currentGame.setWinner(opp);
                serverComment = message.get(8);
                updateResultLabel("You lost!");
                break;
            case "DRAW":
                gameIsOver = true;
                System.out.println("Its a draw");
                //currentGame.setWinner(opp);
                serverComment = message.get(8);
                updateResultLabel("There was a draw!");
                break;
            case "CHALLENGE":
                if(message.get(1).equals("CANCELLED")) {
                    // Challengenumber to remove from table;
                    inviteTable.remove(Integer.valueOf(message.get(3)));
                } else {
                    String challenger = message.get(2);
                    String gameType = message.get(4);
                    Integer challengeNumber = Integer.valueOf(message.get(6));

                    List<String> invite = new ArrayList<>(Arrays.asList(challenger, gameType));
                    inviteTable.put(challengeNumber, invite);
                }
            default:
                System.err.println("Iets klopt niet helemaal.");
        }
    }

    // Registers the move an passes it to the current game model
    // Will only be called when ONLINE
    public void play(int i, int j, byte turn) {
        currentGame.playMove(i, j, turn);
        if(currentGame.equals(reversiGame)){
            updateSideBarReversiScore();
        }
    }

    // Handles AI and Human moves
    public void playMove(int i, int j, byte turn) {
        if(currentGame.possibleMovev2(currentGame.getBoard(), turn, i, j)) {
            if (connected) {
                if(currentGame.equals(reversiGame)){
                    serverCommander.sendMoveCommand(8 * i + j);
                } else if(currentGame.equals(ticTacToeGame)) {
                    serverCommander.sendMoveCommand(3 * i + j);
                }
                currentGame.removeHighlightPossibleMoves();
                updateSidebarTurnLabel(opponentName);
                myTurn = false;
            }
            else {
                currentGame.playMove(i, j, turn);
                updateSideBarReversiScore();
                playerTurn = playerTurn==(byte)1?(byte)2:(byte)1;
                updateSidebarTurnLabel(String.valueOf(playerTurn));
                currentGame.removeHighlightPossibleMoves();
                myTurn = true;
            }
        } else
            if(playingAsAI) System.out.println("AI: not possible move");
            else System.out.println("Human: not possible move");
    }

    public void startServerCommand(String hostname, int port) {
        serverCommander = new ServerCommand(hostname, port);
        connected = serverCommander.getConnectionStatus();
        if (connected) {
            serverCommander.getServerListener().registerObserver(this);
            window.connected();
        }
    }

    public void startGame(String gameType, String playingAs) {
        playerTurn = 1;
        if(gameType.equals("Reversi")) {
            currentGame = reversiGame;
            currentGame.resetBoard();
            window.gameStarted(gameType);
            currentGame.updateView();
            if (playingAs.equals("AI")){
                currentAI = new negaAI(currentGame);
                playingAsAI = true;
            }
//			if(!myTurn)
//				reversiGame.removeHighlightPossibleMoves();
        } else if (gameType.equals("Tic-tac-toe")) {
            currentGame = ticTacToeGame;
            currentGame.resetBoard();
            window.gameStarted(gameType);
            currentGame.updateView();
            if (playingAs.equals("AI")){
                currentAI = new randomAI(currentGame);
                playingAsAI = true;
            }
        }
        else if (playingAs.equals("Human")) {
            currentAI = null;
            playingAsAI = false;
        }
    }
    /******************************************** View update methods *********************************************/

    public void updateSideBarReversiScore() {
        if(currentGame.equals(reversiGame)) {
            if(getLoggedInStatus()){
                if(opp == (byte) 1) {
                    window.getGameSidebarPanel().updateSidebarLabelScore(opponentName, currentGame.score((byte) 1) ,"You", currentGame.score((byte) 2));
                } else
                    window.getGameSidebarPanel().updateSidebarLabelScore("You", currentGame.score((byte) 1), opponentName, currentGame.score((byte) 2));
            } else window.getGameSidebarPanel().updateSidebarLabelScore("Black", currentGame.score((byte) 1) ,"White", currentGame.score((byte) 2));
        }
    }

    public void updateSidebarTurnLabel(String player) {
        window.getGameSidebarPanel().updateSidebarLabelPlayerTurn(player);
    }

    public void updateResultLabel(String result) {
        window.getGameSidebarPanel().setGameResult(result, serverComment);
    }

    public void returnToMenu() {
        window.forfeited();
    }

    /******************************************** Send command to server methods *********************************************/

    public void sendForfeit() {
        serverCommander.sendForfeitCommand();
        window.forfeited();
    }

    public void sendLogout() {
        serverCommander.sendLogoutCommand();
        connected = serverCommander.getConnectionStatus();
        window.loggedOut();
    }

    /******************************************** Setter and Getter methods *********************************************/

    public void setLoggedIn(String username){
        if(serverCommander.sendLoginCommand(username) != null) {
            this.username = username;
            window.loggedIn();
            isLoggedIn = true;
            window.getGameSettingsPanel().setPlayButton();
        } else {
            isLoggedIn = false;
        }
    }

    public String setPlayingAs() {
        return window.getGameSettingsPanel().getPlayAs();
    }

    private void setOpponentColor(int color) {
        opp = (byte) color;
        turn = opp==(byte)1?(byte)2:(byte)1;
    }

    public Game getReversiGame() {
        return reversiGame;
    }

    public Game getTicTacToeGame() { return ticTacToeGame; }

    public ServerCommand getServerCommander(){
        return serverCommander;
    }

    public Hashtable getInvites() {
        return inviteTable;
    }

    public Game getCurrentGame() {
        return currentGame;
    }

    public String getUsername() {
        return username;
    }

    public String getOpponentName() {
        return opponentName;
    }

    public boolean getLoggedInStatus() {
        return isLoggedIn;
    }

    public byte getTurn() {
        return turn;
    }

    public byte getOfflineTurn() {
        return playerTurn;
    }

    public boolean isLoggedIn() {
        return isLoggedIn;
    }

    public boolean isConnected() {
        return connected;
    }

    public boolean isMyTurn() {
        return myTurn;
    }

    public boolean isGameOver() {
        return gameIsOver;
    }

    public boolean isPlayingAsAI() {
        return playingAsAI;
    }

    public static void main(String[] args) {
        new ClientController();
    }
}
